#Función que hace el listado de archivos ocultos y los guarda en un la carpeta "Archivos ocultos"


function Save-HiddenFiles {
	param(
		[string] $directorio
	)

	#Primero revisamos que existe el directorio que ingreso el usuario
	if (-Not (Test-Path -Path $directorio -PathType Container)){
		Write-Error "El directorio $directorio no existe"
		return
	}

	#Aquí se crea la carpeta donde se guardaran los archivos ocultos en caso de que no exista aun 
	$carpeta = Join-Path -Path $directorio -ChildPath "Archivos Ocultos"
	if (-Not (Test-Path -Path $carpeta)) {
		New-Item -Path $carpeta -ItemType Directory | Out-Null
	}

	#Se guarda el listado de los archivos ocultos 
	$archivosocultos = Get-ChildItem -Path $directorio -File -Force | Where-Object { $_.Attributes -match "Hidden" }

	#Se crea el archivo donde se guardara el listado
	$archivolistado = Join-Path -Path $carpeta -ChildPath "LisArchivosOcultos.txt"


	#Si no hay archivos ocultos en el directorio actual, se devuelve un mensaje al usuario
	if ($archivosocultos.Count -eq 0) {
		Write-Output "No hay archivos ocultos"

	} else {
		$archivosocultos | ForEach-Object { $_.Name } | Out-File -FilePath $archivolistado
		Write-Output "Los archivos ocultos se han guardado en $archivolistado" 
	}
}
